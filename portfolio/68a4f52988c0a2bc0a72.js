(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{451:function(e,t,r){},452:function(e,t,r){},453:function(e,t,r){},454:function(e,t,r){},479:function(e,t,r){"use strict";var i=r(451);r.n(i).a},480:function(e,t,r){"use strict";var i=r(452);r.n(i).a},481:function(e,t,r){"use strict";var i=r(453);r.n(i).a},482:function(e,t,r){"use strict";var i=r(454);r.n(i).a},485:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"reviews-page"},[e.isLoading?r("div",{staticClass:"reviews-page__preloader"},[r("clip-loader",{attrs:{color:e.accentColor,size:70}})],1):[r("div",{staticClass:"reviews-page__title"},[r("page-title")],1),e.isShowForm?r("div",{ref:"form",staticClass:"reviews-page__form"},[r("review-form",{attrs:{"is-sending":e.isSendingForm,"current-review":e.currentReview},on:{reset:e.cancelReviewChanges,create:e.createNewReview,update:e.updateCurrentReview}})],1):e._e(),r("div",{staticClass:"reviews-page__grid"},[r("card-gradient-button",{staticClass:"reviews-page__item",attrs:{"is-disabled":e.isShowForm&&!e.currentReview},on:{click:e.addReview}},[e._v("Добавить "),r("br"),e._v(" отзыв")]),e._l(e.reviews,(function(t){return r("review-item",{key:t.id,staticClass:"reviews-page__item",attrs:{review:t,"is-active":t===e.currentReview},on:{edit:function(r){return e.editReview(t)},delete:function(r){return e.deleteReview(t.id)}}})}))],2)]],2)};i._withStripped=!0;var a=r(68),n=r(431),s=r(101),o=r(425),c=r(457),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("card",{staticClass:"new-review"},[r("div",{staticClass:"new-review__header",attrs:{slot:"title"},slot:"title"},[e._v("Новый отзыв")]),r("template",{slot:"content"},[r("form",{staticClass:"new-review__form",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[r("div",{staticClass:"new-review__photo"},[r("avatar-upload",{attrs:{"error-message":e.validation.firstError("reviewData.photo")},model:{value:e.reviewData.photo,callback:function(t){e.$set(e.reviewData,"photo",t)},expression:"reviewData.photo"}})],1),r("div",{staticClass:"new-review__name"},[r("simple-input",{attrs:{label:"Имя автора","error-message":e.validation.firstError("reviewData.author")},model:{value:e.reviewData.author,callback:function(t){e.$set(e.reviewData,"author",t)},expression:"reviewData.author"}})],1),r("div",{staticClass:"new-review__position"},[r("simple-input",{attrs:{label:"Титул автора","error-message":e.validation.firstError("reviewData.occ")},model:{value:e.reviewData.occ,callback:function(t){e.$set(e.reviewData,"occ",t)},expression:"reviewData.occ"}})],1),r("div",{staticClass:"new-review__text"},[r("simple-textarea",{attrs:{label:"Отзыв","error-message":e.validation.firstError("reviewData.text")},model:{value:e.reviewData.text,callback:function(t){e.$set(e.reviewData,"text",t)},expression:"reviewData.text"}})],1),r("div",{staticClass:"new-review__controls"},[r("basic-button",{staticClass:"new-review__button",attrs:{size:"small",display:"flat",disabled:e.isSending},on:{click:function(t){return e.$emit("reset")}}},[e._v("Отмена")]),r("basic-button",{staticClass:"new-review__button new-review__button_save",attrs:{type:"submit",size:"small",bordered:!0,disabled:e.isSending}},[e._v("Сохранить")])],1)])])],2)};u._withStripped=!0;var l=r(70),v=r.n(l),p=r(424),w=r(423),d=r(456),f=r(148),m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"avatar-upload"},[r("label",{staticClass:"avatar-upload__control",attrs:{for:"file-input"}},[e.renderedPhoto?r("img",{staticClass:"avatar-upload__image",attrs:{src:e.renderedPhoto}}):e._e()]),r("input",{ref:"file-input",staticClass:"avatar-upload__file",attrs:{id:"file-input",type:"file",accept:"image/jpeg,image/png"},on:{change:e.handlePhotoUpload}}),r("basic-button",{staticClass:"avatar-upload__button",attrs:{size:"small",display:"flat"},on:{click:e.uploadFile}},[e._v(e._s(e.value?"Изменить фото":"Добавить фото"))]),r("transition",{attrs:{name:"slide-up"}},[e.errorMessage?r("div",{staticClass:"avatar-upload__error"},[r("error-tooltip",[e._v(e._s(e.errorMessage))])],1):e._e()])],1)};m._withStripped=!0;var h=r(149),_=r(455),b={components:{ErrorTooltip:h.a,BasicButton:f.a},mixins:[_.a]},g=(r(479),r(18)),R=Object(g.a)(b,m,[],!1,null,"18e1ac2c",null);R.options.__file="src/admin/components/AvatarUpload.vue";var C=R.exports;function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(r,!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D={author:"",occ:"",text:"",photo:null},j={components:{Card:p.a,SimpleInput:w.a,SimpleTextarea:d.a,BasicButton:f.a,AvatarUpload:C},props:{currentReview:{type:Object,default:null},isSending:{type:Boolean,default:!1}},watch:{currentReview:function(){this.updateReviewData(),this.validation.reset()}},mixins:[v.a.mixin],data:function(){return{reviewData:D}},validators:{"reviewData.author":function(e){return l.Validator.value(e).required("Введите автора")},"reviewData.occ":function(e){return l.Validator.value(e).required("Введите титул")},"reviewData.text":function(e){return l.Validator.value(e).required("Введите текст отзыва")},"reviewData.photo":function(e){return l.Validator.value(e).required("Загрузите фото")}},computed:{title:function(){return this.currentReview?"Редактирование отзыва":"Новый отзыв"}},methods:{updateReviewData:function(){this.reviewData=this.currentReview?y({},this.currentReview):y({},D)},onSubmit:function(){var e=this;this.$validate().then((function(t){if(t){var r=e.currentReview?"update":"create";e.$emit(r,e.reviewData),e.validation.reset()}}))}},created:function(){this.updateReviewData()}},S=(r(480),Object(g.a)(j,u,[],!1,null,"3cb3d328",null));S.options.__file="src/admin/components/ReviewForm.vue";var P=S.exports,F=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("card",{staticClass:"review-item",class:{"review-item_active":e.isActive}},[r("div",{staticClass:"review-item__header",attrs:{slot:"title"},slot:"title"},[r("img",{staticClass:"review-item__user-avatar",attrs:{src:e.imageSrc}}),r("div",{staticClass:"review-item__user-info"},[r("div",{staticClass:"review-item__user-name"},[e._v(e._s(e.review.author))]),r("div",{staticClass:"review-item__user-position"},[e._v(e._s(e.review.occ))])])]),r("template",{slot:"content"},[r("div",{staticClass:"review-item__text"},[e._v(e._s(e.review.text))]),r("div",{staticClass:"review-item__controls"},[r("button",{staticClass:"review-item__button review-item__button_edit",on:{click:function(t){return e.$emit("edit")}}},[r("div",{staticClass:"review-item__button-text"},[e._v("Править")]),r("icon",{staticClass:"review-item__button-icon_edit",attrs:{name:"pencil"}})],1),r("button",{staticClass:"review-item__button review-item__button_delete",on:{click:function(t){return e.$emit("delete")}}},[r("div",{staticClass:"review-item__button-text"},[e._v("Удалить")]),r("icon",{staticClass:"review-item__button-icon_delete",attrs:{name:"cross"}})],1)])])],2)};F._withStripped=!0;var k=r(445),$=r(55),E={components:{Card:p.a,Icon:$.a},props:{review:{type:Object,default:{}},isActive:{type:Boolean,default:!1}},data:function(){return{}},computed:{imageSrc:function(){return Object(k.a)(this.review.photo)}}},T=(r(481),Object(g.a)(E,F,[],!1,null,"0b99c53b",null));T.options.__file="src/admin/components/ReviewItem.vue";var B=T.exports;function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(r,!0).forEach((function(t){z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var A={components:{PageTitle:o.a,CardGradientButton:c.a,ReviewForm:P,ReviewItem:B,ClipLoader:n.ClipLoader},data:function(){return{currentReview:null,isShowForm:!1,isSendingForm:!1,isLoading:!1,accentColor:s["accent-color"]}},computed:q({},Object(a.c)("reviews",{reviews:function(e){return e.reviews}})),methods:q({},Object(a.b)("reviews",["fetchReviews","createReview","updateReview","removeReview"]),{},Object(a.b)("tooltips",["showTooltip"]),{createNewReview:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isSendingForm=!0,t.prev=1,t.next=4,regeneratorRuntime.awrap(this.createReview(e));case 4:this.showTooltip({type:"success",text:"Отзыв успешно создан",duration:3e3}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),this.showTooltip({type:"error",text:t.t0.message,duration:3e3});case 10:return t.prev=10,this.isSendingForm=!1,t.finish(10);case 13:this.hideForm();case 14:case"end":return t.stop()}}),null,this,[[1,7,10,13]])},updateCurrentReview:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.isSendingForm=!0,t.prev=1,t.next=4,regeneratorRuntime.awrap(this.updateReview(e));case 4:this.showTooltip({type:"success",text:"Отзыв успешно обновлен",duration:3e3}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),this.showTooltip({type:"error",text:t.t0.message,duration:3e3});case 10:return t.prev=10,this.isSendingForm=!1,t.finish(10);case 13:this.hideForm();case 14:case"end":return t.stop()}}),null,this,[[1,7,10,13]])},deleteReview:function(e){return regeneratorRuntime.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,regeneratorRuntime.awrap(this.removeReview(e));case 3:this.showTooltip({type:"success",text:"Отзыв успешно удален",duration:3e3}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),this.showTooltip({type:"error",text:t.t0.message,duration:3e3});case 9:case"end":return t.stop()}}),null,this,[[0,6]])},showForm:function(){var e=this;this.isShowForm=!0,this.$nextTick((function(){e.$scrollTo(e.$refs.form,500,{container:".inner-page__content",offset:-50})}))},hideForm:function(){this.isShowForm=!1,this.currentReview=null},addReview:function(){this.currentReview=null,this.showForm()},cancelReviewChanges:function(){this.currentReview=null,this.hideForm()},editReview:function(e){this.currentReview=e,this.showForm()},fetchData:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.prev=1,e.next=4,regeneratorRuntime.awrap(this.fetchReviews());case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.showTooltip({type:"error",text:"Произошла ошибка при загрузке отзывов",duration:3e3});case 9:return e.prev=9,this.isLoading=!1,e.finish(9);case 12:case"end":return e.stop()}}),null,this,[[1,6,9,12]])}}),created:function(){this.fetchData()}},I=(r(482),Object(g.a)(A,i,[],!1,null,"2043995e",null));I.options.__file="src/admin/views/Reviews.vue";t.default=I.exports}}]);